<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1024, height=768">
    <title>Arc Scroll Component</title>
    <link rel="stylesheet" href="../css/components/arc-scroll.css">
</head>
<body>
    <div id="arc-guide"></div>
    <div id="container"></div>
    <div id="debug"></div>
    <div id="scroll-hint">Scroll or use ↑↓ to navigate</div>
    <script src="../js/components/arc-scroll.js"></script>
    <script>
        // WebSocket connection for navigation wheel events
        let ws = null;
        
        function connectWebSocket() {
            try {
                ws = new WebSocket('ws://localhost:8765');
                
                ws.onopen = () => {
                    console.log('WebSocket connected');
                };
                
                ws.onmessage = (event) => {
                    try {
                        const data = JSON.parse(event.data);
                        handleWebSocketMessage(data);
                    } catch (error) {
                        console.error('Error parsing WebSocket message:', error);
                    }
                };
                
                ws.onclose = () => {
                    console.log('WebSocket disconnected');
                    // Attempt to reconnect after 2 seconds
                    setTimeout(() => connectWebSocket(), 2000);
                };
                
                ws.onerror = (error) => {
                    console.error('WebSocket error:', error);
                };
            } catch (error) {
                console.error('Error creating WebSocket:', error);
            }
        }
        
        function handleWebSocketMessage(data) {
            // Listen for navigation wheel events (not volume or laser)
            if (data.type === 'nav' && data.data) {
                const direction = data.data.direction; // 'clock' or 'counter'
                
                // Scroll the page content
                if (direction === 'clock') {
                    // Scroll down
                    window.scrollBy(0, 50);
                } else if (direction === 'counter') {
                    // Scroll up
                    window.scrollBy(0, -50);
                }
                
                // Send click command back to server
                sendClickCommand();
            }
        }
        
        function sendClickCommand() {
            if (ws && ws.readyState === WebSocket.OPEN) {
                const message = {
                    type: 'command',
                    command: 'click',
                    params: {}
                };
                
                ws.send(JSON.stringify(message));
                console.log('Sent click command to server');
            }
        }
        
        // Initialize WebSocket connection when page loads
        document.addEventListener('DOMContentLoaded', () => {
            connectWebSocket();
        });
    </script>
</body>
</html> 